<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Endocrine Enigma — Virtual Escape Room</title>
<style>
body{margin:0;font-family:sans-serif;background:#021021;color:#e6eef6;}
.container{max-width:800px;margin:20px auto;padding:20px;}
.card{background:#0b1220;padding:15px;border-radius:10px;margin-top:15px;}
button{padding:10px 15px;border:none;border-radius:8px;background:#7dd3fc;color:#012;font-weight:700;cursor:pointer;}
input{padding:8px;width:100%;margin-top:5px;border-radius:5px;border:1px solid #444;background:transparent;color:#fff;}
.timer{font-weight:700;color:#fef3c7;margin-top:5px;}
.success{background:#16a34a;color:#042;padding:10px;border-radius:8px;margin-top:10px;}
.error{background:#3b0f0f;color:#ffd6d6;padding:10px;border-radius:8px;margin-top:10px;}
.hint{background:#08202b;color:#ffd;padding:8px;border-radius:5px;margin-top:10px;}
</style>
</head>
<body>
<div class="container">
<h1>The Endocrine Enigma — Virtual Escape Room</h1>
<div class="timer" id="timer">60:00</div>

<div class="card" id="intro">
<p>Dr. Mercer has disappeared. Solve 8 patient cases to reveal digits for the final code.</p>
<button id="startBtn">Start Investigation</button>
<button onclick="showHints()">Show Hints</button>
<div id="hintPanel" class="hint" style="display:none;">Hints: Think clinically—electrolytes, vitals, typical exam findings. Answers are case-insensitive.</div>
</div>

<div id="gameArea"></div>

<div class="card" id="finalPanel" style="display:none">
<label>Enter final 8-digit code:</label>
<input type="text" id="finalCode" maxlength="8">
<button id="finalCheck">Unlock</button>
<div id="finalFeedback"></div>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function(){
const cases=[
{q:"Polyuria, polydipsia, high glucose",a:"diabetes",d:3},
{q:"Fatigue, cold intolerance, bradycardia",a:"hypothyroidism",d:7},
{q:"Exophthalmos, heat intolerance, tachycardia",a:"hyperthyroidism",d:2},
{q:"Moon face, truncal obesity, buffalo hump",a:"cushings",d:5},
{q:"Fatigue, hypotension, hyperpigmentation",a:"addisons",d:8},
{q:"Goiter, tremor, weight loss",a:"grave",d:1},
{q:"Low calcium, tetany",a:"hypoparathyroidism",d:4},
{q:"High calcium, kidney stones",a:"hyperparathyroidism",d:6}
];

const startBtn=document.getElementById('startBtn');
const gameArea=document.getElementById('gameArea');
const finalPanel=document.getElementById('finalPanel');
const finalCodeInput=document.getElementById('finalCode');
const finalCheck=document.getElementById('finalCheck');
const finalFeedback=document.getElementById('finalFeedback');
let timer=60*60; 
let timerInterval;
let revealed=[];

function startTimer(){
timerInterval=setInterval(()=>{
timer--;
let m=Math.floor(timer/60).toString().padStart(2,'0');
let s=(timer%60).toString().padStart(2,'0');
document.getElementById('timer').textContent=`${m}:${s}`;
if(timer<=0){clearInterval(timerInterval);alert("Time's up!");}
},1000);
}

window.showHints=function(){document.getElementById('hintPanel').style.display='block';}

function createCases(){
gameArea.innerHTML="";
cases.forEach((c,i)=>{
let card=document.createElement('div');
card.className="card";
let label=document.createElement('label');
label.textContent=c.q;
let input=document.createElement('input');
input.type="text";
input.dataset.index=i;
input.placeholder="Enter diagnosis";
let btn=document.createElement('button');
btn.type="button";
btn.textContent="Check";
btn.onclick=function(){
let val=input.value.trim().toLowerCase();
if(val===c.a){
if(!revealed.includes(c.d)) revealed.push(c.d);
alert("Correct! Digit: "+c.d);
if(revealed.length===cases.length){finalPanel.style.display='block';}
}else{alert("Incorrect, try again.");}
};
card.appendChild(label);
card.appendChild(input);
card.appendChild(btn);
gameArea.appendChild(card);
});
}

startBtn.addEventListener("click",function(){
createCases();
startBtn.disabled=true;
startTimer();
});

finalCheck.addEventListener("click",function(e){
e.preventDefault();
const code=finalCodeInput.value.trim();
const correct=cases.map(c=>c.d).join('');
if(code===correct){finalFeedback.innerHTML="<div class='success'>Congratulations! Dr. Mercer has been located!</div>";}
else{finalFeedback.innerHTML="<div class='error'>Incorrect code. Keep trying!</div>";}
});
});
</script>
</body>
</html>
